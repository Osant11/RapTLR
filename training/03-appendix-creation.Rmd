# Appendix Creation {#appendix-creation}

## The run_apdx() Function

The `run_apdx()` function automatically:

1. By default, reads all docx files from a specified folder
2. Inserts them into your Word document
3. Creates a table of contents with hyperlinks
4. Organizes outputs into sections (optional)

In the RapTLR package, we provided few examples to cover most of the use cases for `run_apdx()` function and you can access them in the function's documentation.

## Basic Usage

The most simple case, you only need to specify two arguments:

- path_TLFs: Path of the directory where the .docx outputs are saved
- docx_object: Path of the targeted .docx is saved. (e.g. TLR_shell.docx)

Automatically, the function will create a subfolder called `bookmarked` at the same directory of `path_TLFs` and will create bookmarked .docx outputs for each .docx outputs.

In the Package, we provided dummy .docx outputs and a TLR shell for practising. You can find them [here](https://github.com/johnsonandjohnson/RapTLR/tree/main/inst/extdata). 

When you download the package, you can get their location in R in that way: 

```{r eval = FALSE} 

path_TLFs <- system.file("extdata/TLF_outputs", package = "RapTLR")
path_docx <- system.file("extdata", "TLR_Shell.docx", package = "RapTLR")

```



```{r eval=FALSE}
library(RapTLR)

run_apdx(
  path_TLFs = "C:/Documents/TLR_folder/TLF_outputs",
  docx_object = "C:/Documents/TLR_folder/TLR_shell.docx",
  keyword = "LISTOFAPPENDICES",
  return_to_file = "C:/Documents/TLR_folder/TLR_final.docx"
)
```

## Function Parameters

### Required Parameters

**path_TLFs** - Path to folder containing PDF files

**docx_object** - Path to your shell Word document OR an existing officer object

**keyword** - Placeholder text to replace with appendix list

### Optional Parameters

**return_to_file** - Path where final document should be saved

**sections_structure** - Organizes TLFs into sections (list, data frame, or CSV)

## Organizing with Sections

### Method 1: Using a List

```{r eval=FALSE}
output_list <- list(
  "Efficacy Tables" = c("t_efficacy_01", "t_efficacy_02"),
  "Safety Tables" = c("t_adverse_events_01", "t_labs_01"),
  "Listings" = c("l_deaths_01", "l_serious_ae_01")
)

run_apdx(
  path_TLFs = "TLF_outputs/",
  docx_object = "TLR_shell.docx",
  keyword = "LISTOFAPPENDICES",
  sections_structure = output_list,
  return_to_file = "TLR_final.docx"
)
```

### Method 2: Using a CSV File

Create `TLF_structure.csv`:

```
Section,TLF_Name
Efficacy Tables,t_efficacy_01
Safety Tables,t_adverse_events_01
```

Then use it:

```{r eval=FALSE}
run_apdx(
  path_TLFs = "TLF_outputs/",
  docx_object = "TLR_shell.docx",
  keyword = "LISTOFAPPENDICES",
  sections_structure = "TLF_structure.csv",
  return_to_file = "TLR_final.docx"
)
```




Your appendices are now automatically inserted!
